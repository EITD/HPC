import numpy as np

# inter
sizes = np.array([8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824])
times = np.array([0.000001892, 0.000001885, 0.000001952, 0.000002035, 0.000002511, 0.000002552, 0.000002654, 0.000002684, 0.000002778, 0.000002928, 0.000003186, 0.000003510, 0.000006277, 0.000007659, 0.000010357, 0.000015727, 0.000026579, 0.000051423, 0.000102720, 0.000213885, 0.000393033, 0.001176882, 0.002293429, 0.004616542, 0.008943373, 0.015326157, 0.034840755, 0.061519315])

# intra
# sizes = np.array([8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824])
# times = np.array([0.000000779, 0.000000352, 0.000000253, 0.000000252, 0.000000273, 0.000000324, 0.000000418, 0.000000618, 0.000000954, 0.000001527, 0.000000738, 0.000001192, 0.000001885, 0.000003314, 0.000006065, 0.000011195, 0.000020599, 0.000037198, 0.000074343, 0.000112891, 0.000380859, 0.001526539, 0.002692446, 0.004809135, 0.008834347, 0.017287095, 0.033448286, 0.066663556])

r, s = np.polyfit(sizes, times, 1)

print("Slope:", r)
print("Bandwidth:", 1 / r / 10**9)
print("Latency:", s)
